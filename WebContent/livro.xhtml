<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html">

<h:head></h:head>
<h:body>

	<h1>Novo livro</h1>
	<h:form>
		<fieldset>
			<legend>Dados do livro</legend>
			<h:panelGrid columns="2">
				<h:outputLabel value="Titulo" for="titulo" />
				<h:inputText value="#{livroBean.livro.titulo}" id="titulo" />
				<h:outputLabel value="Isbn:" for="isbn" />
				<h:inputText value="#{livroBean.livro.isbn}" id="isbn" />
				<h:outputLabel value="Preco:" for="preco" />
				<h:inputText value="#{livroBean.livro.preco}" id="preco" />
				<h:outputLabel value="Data de Lançamento:" for="dataLancamento" />
				<h:inputText value="#{livroBean.livro.dataLancamento}"
					id="dataLancamento" />
			</h:panelGrid>
		</fieldset>

		<fieldset>
			<legend>Dados do Autor</legend>
			<h:outputLabel value="Selecione Autor" for="autor" />

			<!-- Pega o itemValue selecionado e popula no nosso ManagedBean -->
			<h:selectOneMenu id="autor" value="#{livroBean.autorId}">
				<!-- 
				value ~> lista de autores
				var ~> indica um autor dentro da iteração pela lista de autores
				itemLabel ~> o que vamos mostrar do autor
				itemValue ~> associar um valor ao item
			 	-->
				<f:selectItems value="#{livroBean.autores}" var="autor"
					itemLabel="#{autor.nome}" itemValue="#{autor.id}" />
			</h:selectOneMenu>
			<!-- Método para associar autor ao livro -->
			<h:commandButton action="#{livroBean.gravarAutor}"
				value="Gravar Autor" />

			<!-- Mesmo padrão do selectItems -->
			<h:dataTable value="#{livroBean.autoresDoLivro}" var="autor">
				<h:column>
					<h:outputText value="#{autor.nome}" />
				</h:column>
			</h:dataTable>
		</fieldset>

		<h:commandButton action="#{livroBean.gravar}" value="Registrar" />
	</h:form>

	<h:dataTable id="tabelaDeLivros" value="#{livroBean.livros}"
		style="width:50%" var="livro">
		<h:column>
			<!-- setando o cabeçalho das colunas -->
			<f:facet name="header">Título</f:facet>
			<h:outputText value="#{livro.titulo}" />
		</h:column>
		<h:column>
			<f:facet name="header">Isbn</f:facet>
			<h:outputText value="#{livro.isbn}" />
		</h:column>
		<h:column>
			<f:facet name="header">Preço</f:facet>
			<h:outputText value="#{livro.preco}" />
		</h:column>
		<h:column>
			<f:facet name="header">Data de lançamento</f:facet>
			<h:outputText value="#{livro.dataLancamento}" />
		</h:column>
	</h:dataTable>
</h:body>
</html>
